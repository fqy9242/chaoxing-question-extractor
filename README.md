# 📚 超星学习通作业题目提取工具 (背题模式增强版)

> **⚠️ 说明 / Disclaimer**
>
> 本脚本基于原作者 **Assistant** 的版本进行**二次修改与功能增强**。
> 主要目的是为了适配**刷题软件（如 Anki）导入**以及**打印背诵**的需求，优化了导出格式。

## 📖 简介

这是一个用于提取超星学习通（Chaoxing/Xuexitong）作业页面的 Tampermonkey 油猴脚本。它可以自动抓取页面上的题目、选项、图片、正确答案和解析，并支持生成排版精美的 Word 文档。

**v1.7 核心亮点：** 专为“背题”设计，支持智能去除原题括号、文字答案自动转换为选项字母（A/B/C/D）。

## ✨ 功能特性

* **📷 全面提取**：支持提取题目文本、选项、图片、正确答案、我的答案、解析、得分。
* **🧩 智能去括号**：(新功能) 导出时自动移除题目中原有的 `( )` 或 `（ ）` 占位符，防止出现“双括号”。
* **🔠 答案自动转字母**：(新功能)
    * **判断题**：自动将“对/正确/√”转换为 **A**，“错/错误/×”转换为 **B**。
    * **文字选项**：如果系统提供的答案是文字（如“数组”），脚本会自动匹配选项列表，将其转换为对应的 **A/B/C/D**。
* **📝 两种导出模式**：
    1.  **背题模式 (推荐)**：紧凑排版，格式为 `9. 题目内容(A)`，答案高亮显示，适合导入 Anki 或打印背诵。
    2.  **详细解析版**：包含完整解析、得分、我的答案等详细信息。
* **🖼️ 图片支持**：题目、选项、解析中的图片均可嵌入 Word 文档中。

## 🛠️ 安装方法

1.  安装浏览器扩展 **Tampermonkey** (油猴)。
2.  点击 [安装脚本](您的脚本链接) 或新建脚本将代码复制进去。
3.  打开超星学习通的作业详情页面（URL 通常包含 `/mooc-ans/mooc2/work/view`）。

## 📖 使用指南

1.  **进入作业页面**：打开你需要提取的作业或考试详情页。
2.  **点击悬浮球**：页面右下角会出现一个紫色的 **📝** 悬浮按钮，点击它。
3.  **解析题目**：在弹出的面板中点击 **“1. 解析题目”**，脚本会自动抓取当前页面的所有数据。
4.  **选择导出格式**：
    * 点击 **“2. 下载 背题模式(Word)”**：获取纯净的刷题文档（自动去括号+答案转字母）。
    * 点击 **“3. 下载 详细解析版(Word)”**：获取包含解析的完整文档。

## 🔄 更新日志 (二次修改记录)

### v1.7 (当前版本)
* ✅ **新增**：智能答案转换逻辑。判断题自动转 A/B，文本答案自动匹配选项转 A/B/C/D。
* ✅ **优化**：导出时自动移除题目中原有的空括号，避免格式冗余。
* ✅ **优化**：背题模式下，括号内的答案统一显示为红色，更加醒目。

### v1.6
* ✅ **新增**：“背题模式” Word 导出功能。
* ✅ **格式**：调整 Word 行距和排版，使其更紧凑，节省打印纸张。

### v1.3 - v1.5 (原版功能基础)
* 基础的题目解析、图片下载及 Word 生成功能。

## 📦 依赖库
本脚本使用了以下开源库（已通过 `@require` 引用）：
* [docx](https://github.com/dolanmiu/docx): 用于在浏览器端生成 Word 文档。
* [FileSaver.js](https://github.com/eligrey/FileSaver.js): 用于保存文件。

---
*Created by Assistant, Modified by [您的名字/ID]*
